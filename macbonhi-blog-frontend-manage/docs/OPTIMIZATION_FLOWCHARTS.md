# ä¼˜åŒ–æ–¹æ¡ˆæµç¨‹å›¾

> æœ¬æ–‡æ¡£é€šè¿‡æ–‡å­—å›¾ç¤ºçš„æ–¹å¼ï¼Œç›´è§‚å±•ç¤ºè™šæ‹Ÿæ»šåŠ¨å’Œå¹¶å‘æ§åˆ¶çš„å®ç°æµç¨‹ã€‚

---

## ğŸ¯ æ–¹æ¡ˆä¸€ï¼šè™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯æµç¨‹

### æ•´ä½“æ¶æ„æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è™šæ‹Ÿæ»šåŠ¨ç³»ç»Ÿ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [ç”¨æˆ·æ“ä½œ]
       â†“
   æ»šåŠ¨å®¹å™¨
       â†“
   ç›‘å¬scrolläº‹ä»¶ â”€â”€â”€â”€â†’ requestAnimationFrameèŠ‚æµ
       â†“
   è®¡ç®—scrollTopå€¼
       â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  æ ¸å¿ƒè®¡ç®—å¼•æ“                    â”‚
   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
   â”‚  1. startIndex = scrollTop Ã·    â”‚
   â”‚     itemHeight - buffer         â”‚
   â”‚                                 â”‚
   â”‚  2. endIndex = startIndex +     â”‚
   â”‚     visibleCount + buffer*2     â”‚
   â”‚                                 â”‚
   â”‚  3. visibleItems = items[       â”‚
   â”‚     startIndex...endIndex]      â”‚
   â”‚                                 â”‚
   â”‚  4. offsetY = startIndex Ã—      â”‚
   â”‚     itemHeight                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  DOMæ¸²æŸ“å±‚                       â”‚
   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
   â”‚  å ä½å®¹å™¨ï¼ˆæ€»é«˜åº¦ï¼‰              â”‚
   â”‚    â†“                            â”‚
   â”‚  å¯è§å…ƒç´ å®¹å™¨                   â”‚
   â”‚    â†“ transform: translateY()    â”‚
   â”‚  å®é™…æ¸²æŸ“çš„ç»„ä»¶ï¼ˆ15-20ä¸ªï¼‰       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
   é¡µé¢å±•ç¤º
```

### æ»šåŠ¨äº‹ä»¶å¤„ç†æµç¨‹

```
ç”¨æˆ·æ»šåŠ¨é¼ æ ‡/è§¦æ‘¸å±
    â†“
scrolläº‹ä»¶è§¦å‘ï¼ˆé«˜é¢‘ï¼š100+æ¬¡/ç§’ï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ requestAnimationFrameèŠ‚æµ       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ if (å·²æœ‰rafId) {                â”‚
â”‚   cancelAnimationFrame(rafId)   â”‚
â”‚ }                               â”‚
â”‚ rafId = requestAnimationFrame(  â”‚
â”‚   () => { æ›´æ–°scrollTop }       â”‚
â”‚ )                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
èŠ‚æµåï¼ˆ60æ¬¡/ç§’ï¼Œä¸æµè§ˆå™¨åˆ·æ–°ç‡åŒæ­¥ï¼‰
    â†“
è§¦å‘å“åº”å¼æ›´æ–°
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vueå“åº”å¼ç³»ç»Ÿ                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ computedå±æ€§é‡æ–°è®¡ç®—              â”‚
â”‚ - startIndex âœ“                  â”‚
â”‚ - endIndex âœ“                    â”‚
â”‚ - visibleItems âœ“                â”‚
â”‚ - offsetY âœ“                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Vue Diffç®—æ³•
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOMæ›´æ–°ç­–ç•¥                       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ 1. å¤ç”¨å·²å­˜åœ¨çš„DOMèŠ‚ç‚¹            â”‚
â”‚ 2. é”€æ¯æ»šå‡ºè§†å£çš„èŠ‚ç‚¹             â”‚
â”‚ 3. åˆ›å»ºæ–°è¿›å…¥è§†å£çš„èŠ‚ç‚¹           â”‚
â”‚ 4. æ›´æ–°transformä½ç½®              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
GPUåŠ é€Ÿæ¸²æŸ“ï¼ˆtransformï¼‰
    â†“
ç”¨æˆ·çœ‹åˆ°æµç•…æ»šåŠ¨æ•ˆæœ
```

### æ•°æ®å˜åŒ–å¤„ç†æµç¨‹

```
æ–‡ç« æ•°æ®æ›´æ–°ï¼ˆç­›é€‰/æœç´¢ï¼‰
    â†“
props.itemså˜åŒ–
    â†“
watchç›‘å¬è§¦å‘
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®å˜åŒ–å¤„ç†                      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ 1. é‡ç½®scrollTop = 0             â”‚
â”‚ 2. é‡æ–°è®¡ç®—totalHeight           â”‚
â”‚ 3. é‡æ–°è®¡ç®—visibleItems          â”‚
â”‚ 4. æ¸…ç©ºä¹‹å‰çš„DOM                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
é‡æ–°æ¸²æŸ“å¯è§åŒºåŸŸ
    â†“
å®Œæˆ
```

### æ€§èƒ½å¯¹æ¯”ç¤ºæ„å›¾

```
ä¼ ç»Ÿæ¸²æŸ“ï¼ˆ1000ä¸ªDOMï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Item 1  â”‚ Item 2  â”‚ ... â”‚ Item 999 â”‚ Item 1000        â”‚
â”‚ (å…¨éƒ¨æ¸²æŸ“åœ¨DOMä¸­ï¼Œå†…å­˜å ç”¨é«˜ï¼Œæ¸²æŸ“æ…¢)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
DOM: 1000ä¸ª  |  å†…å­˜: 156MB  |  æ¸²æŸ“æ—¶é—´: 3200ms


è™šæ‹Ÿæ»šåŠ¨ï¼ˆ18ä¸ªDOMï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å ä½å®¹å™¨           â”‚
â”‚ (é«˜åº¦ï¼šitemHeight  â”‚
â”‚  Ã— totalCount)     â”‚
â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å¯è§åŒºåŸŸ     â”‚  â”‚ â† å®é™…æ¸²æŸ“çš„18ä¸ªDOM
â”‚  â”‚ Item 45-63   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
DOM: 18ä¸ª   |  å†…å­˜: 28MB   |  æ¸²æŸ“æ—¶é—´: 450ms
```

---

## ğŸ”„ æ–¹æ¡ˆäºŒï¼šå¹¶å‘æ§åˆ¶æµç¨‹

### æ•´ä½“æ¶æ„æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¹¶å‘æ§åˆ¶ç³»ç»Ÿ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸šåŠ¡ä»£ç å‘èµ·æ‰¹é‡è¯·æ±‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº”ç”¨å±‚                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  articles.forEach(article => {        â”‚
â”‚    controller.add(                    â”‚
â”‚      () => getComments(article.id)    â”‚
â”‚    )                                  â”‚
â”‚  })                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹¶å‘æ§åˆ¶å±‚ï¼ˆConcurrencyControllerï¼‰   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä»»åŠ¡é˜Ÿåˆ— (queue)                â”‚  â”‚
â”‚  â”‚ [task1, task2, ..., task30]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å¹¶å‘æ§åˆ¶å™¨                       â”‚  â”‚
â”‚  â”‚ running: 6/6                    â”‚  â”‚
â”‚  â”‚ maxConcurrency: 6               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯·æ±‚å»é‡å±‚ï¼ˆRequestDeduplicatorï¼‰     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  æ£€æŸ¥1ç§’çª—å£å†…æ˜¯å¦æœ‰ç›¸åŒè¯·æ±‚           â”‚
â”‚  - æœ‰ï¼šå¤ç”¨Promise                    â”‚
â”‚  - æ— ï¼šåˆ›å»ºæ–°è¯·æ±‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç½‘ç»œè¯·æ±‚å±‚ï¼ˆAxiosï¼‰                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  åŒæ—¶å‘é€6ä¸ªå¹¶å‘è¯·æ±‚                   â”‚
â”‚  HTTP/1.1å¹¶å‘é™åˆ¶ï¼š6ä¸ª                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
æœåŠ¡å™¨å“åº”
    â†“
ç»“æœè¿”å›ç»™ä¸šåŠ¡ä»£ç 
```

### ä»»åŠ¡æ‰§è¡Œæ—¶åºå›¾

```
æ—¶é—´è½´ â†’

Task1  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“ (å®Œæˆï¼Œé‡Šæ”¾slot)
Task2  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task3  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task4  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task5  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task6  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task7           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“ (Task1å®Œæˆåå¼€å§‹)
Task8            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task9             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
Task10             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“
...

å¹¶å‘æ•°: |----  6  ----|----  6  ----|----  6  ----|
æ—¶é—´:   0ms   300ms   600ms   900ms   1200ms
```

### ä¸²è¡Œ vs å¹¶å‘å¯¹æ¯”

```
ä¸²è¡Œæ‰§è¡Œï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”
â”‚ T1 â”‚â”€â”€â”€â”€â†’â”‚ T2 â”‚â”€â”€â”€â”€â†’â”‚ T3 â”‚â”€â”€â”€ ... â”€â”€â†’â”‚T30 â”‚
â””â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”˜
æ—¶é—´: 300ms + 300ms + 300ms + ... = 9000ms


å¹¶å‘æ‰§è¡Œï¼ˆä¼˜åŒ–åï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”
â”‚ T1 â”‚â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”˜    â”‚
â”Œâ”€â”€â”€â”€â”    â”‚
â”‚ T2 â”‚â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”˜    â”‚
â”Œâ”€â”€â”€â”€â”    â”œâ”€â”€â†’ å¹¶å‘æ‰§è¡Œ
â”‚ T3 â”‚â”€â”€â”€â”€â”¤    (6ä¸ªåŒæ—¶)
â””â”€â”€â”€â”€â”˜    â”‚
â”Œâ”€â”€â”€â”€â”    â”‚
â”‚ T4 â”‚â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”˜    â”‚
â”Œâ”€â”€â”€â”€â”    â”‚
â”‚ T5 â”‚â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”˜    â”‚
â”Œâ”€â”€â”€â”€â”    â”‚
â”‚ T6 â”‚â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”˜
  â†“ (ç¬¬ä¸€æ‰¹å®Œæˆ)
â”Œâ”€â”€â”€â”€â”
â”‚ T7 â”‚â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”˜    â”‚
  ...     â”œâ”€â”€â†’ ç¬¬äºŒæ‰¹æ‰§è¡Œ
â”Œâ”€â”€â”€â”€â”    â”‚
â”‚T12 â”‚â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”˜

æ—¶é—´: 300ms Ã— (30 Ã· 6) = 1500ms
```

### è¯·æ±‚å»é‡æµç¨‹

```
ç”¨æˆ·å¿«é€Ÿç‚¹å‡»ç­›é€‰æŒ‰é’®
    â†“
è§¦å‘å¤šæ¬¡ç›¸åŒè¯·æ±‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RequestDeduplicator                 â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ 1. ç”Ÿæˆè¯·æ±‚æŒ‡çº¹                      â”‚
â”‚    key = URL + paramsçš„hash         â”‚
â”‚                                     â”‚
â”‚ 2. æ£€æŸ¥pendingRequests Map          â”‚
â”‚    if (map.has(key)) {              â”‚
â”‚      return cached Promise âœ“        â”‚
â”‚    }                                â”‚
â”‚                                     â”‚
â”‚ 3. æ£€æŸ¥æ—¶é—´çª—å£                      â”‚
â”‚    if (now - lastTime < 1000ms) {   â”‚
â”‚      return cached Promise âœ“        â”‚
â”‚    }                                â”‚
â”‚                                     â”‚
â”‚ 4. åˆ›å»ºæ–°è¯·æ±‚                        â”‚
â”‚    promise = axios.post(...)        â”‚
â”‚    map.set(key, promise)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å›Promise
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¸…ç†æœºåˆ¶                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ setInterval(() => {                 â”‚
â”‚   æ¸…ç†è¶…è¿‡2ç§’çš„ç¼“å­˜è®°å½•              â”‚
â”‚ }, 5000)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é‡è¯•æœºåˆ¶æµç¨‹

```
è¯·æ±‚å‘é€
    â†“
ç½‘ç»œé”™è¯¯ / æœåŠ¡å™¨é”™è¯¯
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡è¯•é€»è¾‘ï¼ˆæŒ‡æ•°é€€é¿ï¼‰                 â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                     â”‚
â”‚ ç¬¬1æ¬¡å¤±è´¥                            â”‚
â”‚   â†“                                 â”‚
â”‚ ç­‰å¾…1ç§’ + random(0-300ms)           â”‚
â”‚   â†“                                 â”‚
â”‚ é‡è¯•                                â”‚
â”‚   â†“                                 â”‚
â”‚ ç¬¬2æ¬¡å¤±è´¥                            â”‚
â”‚   â†“                                 â”‚
â”‚ ç­‰å¾…2ç§’ + random(0-600ms)           â”‚
â”‚   â†“                                 â”‚
â”‚ é‡è¯•                                â”‚
â”‚   â†“                                 â”‚
â”‚ ç¬¬3æ¬¡å¤±è´¥                            â”‚
â”‚   â†“                                 â”‚
â”‚ ç­‰å¾…4ç§’ + random(0-1200ms)          â”‚
â”‚   â†“                                 â”‚
â”‚ é‡è¯•                                â”‚
â”‚   â†“                                 â”‚
â”‚ ä»ç„¶å¤±è´¥                             â”‚
â”‚   â†“                                 â”‚
â”‚ æ”¾å¼ƒï¼Œè¿”å›é”™è¯¯                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ä¸šåŠ¡å±‚å¤„ç†é”™è¯¯
```

### å†…å­˜ç®¡ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜Ÿåˆ—ç®¡ç†                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                     â”‚
â”‚ ä»»åŠ¡å…¥é˜Ÿï¼š                           â”‚
â”‚ if (queue.length >= 1000) {         â”‚
â”‚   throw Error("é˜Ÿåˆ—å·²æ»¡")           â”‚
â”‚ }                                   â”‚
â”‚                                     â”‚
â”‚ ä»»åŠ¡å®Œæˆï¼š                           â”‚
â”‚ ç«‹å³ä»Mapä¸­åˆ é™¤                      â”‚
â”‚ ä¸ä¿å­˜ç»“æœï¼ˆé€šè¿‡Promiseè¿”å›ï¼‰        â”‚
â”‚                                     â”‚
â”‚ å®šæœŸæ¸…ç†ï¼š                           â”‚
â”‚ setInterval(() => {                 â”‚
â”‚   æ¸…ç†è¿‡æœŸçš„è¯·æ±‚è®°å½•                 â”‚
â”‚   æ¸…ç†å·²å®Œæˆçš„Promise                â”‚
â”‚ }, 5000)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å†…å­˜å ç”¨ç¨³å®š
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”å¯è§†åŒ–

### è™šæ‹Ÿæ»šåŠ¨æ€§èƒ½å¯¹æ¯”

```
åˆå§‹æ¸²æŸ“æ—¶é—´ï¼š
ä¼ ç»Ÿæ¸²æŸ“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3200ms
è™šæ‹Ÿæ»šåŠ¨ â–ˆâ–ˆâ–ˆâ–ˆ 450ms
         â†‘
         æå‡ 85.9%


å†…å­˜å ç”¨ï¼š
ä¼ ç»Ÿæ¸²æŸ“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 156MB
è™šæ‹Ÿæ»šåŠ¨ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 28MB
         â†‘
         å‡å°‘ 82.1%


æ»šåŠ¨å¸§ç‡ï¼š
ä¼ ç»Ÿæ¸²æŸ“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 25fps
è™šæ‹Ÿæ»šåŠ¨ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 60fps
         â†‘
         æå‡ 140%
```

### å¹¶å‘æ§åˆ¶æ€§èƒ½å¯¹æ¯”

```
30ç¯‡æ–‡ç« åŠ è½½æ—¶é—´ï¼š
ä¸²è¡Œæ¨¡å¼ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 9000ms
å¹¶å‘æ¨¡å¼ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1200ms
         â†‘
         æå‡ 83.3%


ç½‘ç»œèµ„æºåˆ©ç”¨ç‡ï¼š
ä¸²è¡Œæ¨¡å¼ â–ˆâ–ˆâ–ˆâ–ˆ 16.7% (1/6)
å¹¶å‘æ¨¡å¼ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (6/6)
         â†‘
         æå‡ 500%


è¯·æ±‚æ€»æ•°ï¼ˆå»é‡åï¼‰ï¼š
å»é‡å‰   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100æ¬¡
å»é‡å   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 70æ¬¡
         â†‘
         å‡å°‘ 30%
```

---

## ğŸ¯ å®æ–½å†³ç­–æ ‘

```
æ˜¯å¦éœ€è¦ä¼˜åŒ–ï¼Ÿ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é—®é¢˜è¯Šæ–­                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”œâ”€â†’ åˆ—è¡¨æ¸²æŸ“æ…¢ï¼Ÿ
    â”‚      â†“
    â”‚   æ•°æ®é‡ > 50ï¼Ÿ
    â”‚      â†“
    â”‚   ã€å®æ–½è™šæ‹Ÿæ»šåŠ¨ã€‘
    â”‚      ä¼˜å…ˆçº§ï¼šä¸­é«˜
    â”‚      å·¥ä½œé‡ï¼š3-5å¤©
    â”‚
    â”œâ”€â†’ æ•°æ®åŠ è½½æ…¢ï¼Ÿ
    â”‚      â†“
    â”‚   ä¸²è¡Œè¯·æ±‚ï¼Ÿ
    â”‚      â†“
    â”‚   ã€å®æ–½å¹¶å‘æ§åˆ¶ã€‘
    â”‚      ä¼˜å…ˆçº§ï¼šé«˜
    â”‚      å·¥ä½œé‡ï¼š2-3å¤©
    â”‚
    â”œâ”€â†’ é‡å¤è¯·æ±‚å¤šï¼Ÿ
    â”‚      â†“
    â”‚   ã€æ·»åŠ è¯·æ±‚å»é‡ã€‘
    â”‚      ä¼˜å…ˆçº§ï¼šä¸­
    â”‚      å·¥ä½œé‡ï¼š1å¤©
    â”‚
    â””â”€â†’ å†…å­˜å ç”¨é«˜ï¼Ÿ
           â†“
        ã€ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ã€‘
           ä¼˜å…ˆçº§ï¼šä¸­
           å·¥ä½œé‡ï¼š2å¤©
```

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### è™šæ‹Ÿæ»šåŠ¨é€‚ç”¨åœºæ™¯åˆ¤æ–­

```
æ•°æ®é‡åˆ¤æ–­ï¼š
    â†“
< 20æ¡ â”€â”€â†’ ä¼ ç»Ÿæ¸²æŸ“ï¼ˆv-forï¼‰âœ“
    â†“
20-50æ¡ â”€â”€â†’ å¯é€‰è™šæ‹Ÿæ»šåŠ¨
    â†“
> 50æ¡ â”€â”€â†’ å¼ºçƒˆå»ºè®®è™šæ‹Ÿæ»šåŠ¨ â­
    â†“
> 500æ¡ â”€â”€â†’ å¿…é¡»è™šæ‹Ÿæ»šåŠ¨ â­â­â­
```

### å¹¶å‘æ§åˆ¶é€‚ç”¨åœºæ™¯åˆ¤æ–­

```
æ‰¹é‡è¯·æ±‚åˆ¤æ–­ï¼š
    â†“
< 5ä¸ªè¯·æ±‚ â”€â”€â†’ ä¸²è¡Œ/å¹¶è¡Œéƒ½å¯
    â†“
5-10ä¸ªè¯·æ±‚ â”€â”€â†’ å»ºè®®å¹¶å‘æ§åˆ¶
    â†“
> 10ä¸ªè¯·æ±‚ â”€â”€â†’ å¿…é¡»å¹¶å‘æ§åˆ¶ â­
    â†“
> 50ä¸ªè¯·æ±‚ â”€â”€â†’ å¹¶å‘+åˆ†æ‰¹ â­â­â­
```

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æ›´æ–°æ—¶é—´ï¼š** 2025-01-28  
**ç»´æŠ¤è€…ï¼š** å‰ç«¯ä¼˜åŒ–å°ç»„

